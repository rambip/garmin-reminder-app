<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Unit Testing - Garmin Connect IQ Documentation</title>
    <style>
        body { font-family: Arial, sans-serif; line-height: 1.6; margin: 0; padding: 20px; }
        h1 { color: #333; }
        pre { background-color: #f5f5f5; padding: 10px; border-radius: 4px; overflow: auto; }
        code { font-family: monospace; }
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ddd; padding: 8px; }
        th { background-color: #f2f2f2; }
        img { max-width: 100%; }
    </style>
</head>
<body>
    <h1>Unit Testing</h1>
    <div class="c0123 c0126">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><meta charset="utf-8"/><meta content="(C) Copyright 2025" name="copyright"/><meta content="(C) Copyright 2025" name="DC.rights.owner"/><meta content="topic" name="DC.type"/><meta content="HTML5" name="DC.format"/><meta content="unit-testing" name="DC.identifier"/><link href="../../commonltr.css" rel="stylesheet" type="text/css"/><title>Unit Testing</title><main role="main"><article aria-labelledby="ariaid-title1" role="article"><h1 class="title topictitle1" id="ariaid-title1">Unit Testing</h1><div class="body"><p class="p">The Connect IQ SDK has Run No Evil, an automated unit testing framework found in the Test module. Run No Evil operates only within the Connect IQ simulator and provides the ability to add asserts and unit test methods to your app.</p></div><article aria-labelledby="ariaid-title2" class="topic nested1" id="asserts"><h2 class="title topictitle2" id="ariaid-title2">Asserts</h2><div class="body"><p class="p">Asserts are a useful way to check for conditions at critical points in your code and will always execute when your app is launched in the simulator. For example, if your app always expects the value of x and y to not be equal:</p><pre class="pre codeblock typescript"><code>import Toybox.Test;

function onShow() {
  var x = 1;
  var y = 1;
  // Prints an error to the console when x and y are equal
  Test.assertNotEqualMessage(x, y, "x and y are equal!");
}</code></pre><p class="p">The code above produces the following output in the console when the app is run in the Simulator:</p><pre class="pre codeblock bash"><code>Device Version 0.1.0
Device id 1 name "A garmin device"
Shell Version 0.1.0
ASSERTION FAILED: x and y are equal!</code></pre><p class="p">Assert code requires no special compiler commands to execute within the simulator, and are removed by the compiler when building release code. Run No Evil has four different assert flavors:</p><table class="table"><caption></caption><colgroup><col/><col/></colgroup><thead class="thead"><tr class="row"><th class="entry" id="asserts__entry__1">Function</th><th class="entry" id="asserts__entry__2">Description</th></tr></thead><tbody class="tbody"><tr class="row"><td class="entry" headers="asserts__entry__1"><a class="xref" href="https://developer.garmin.com/connect-iq/api-docs/Toybox/Test.html#assert-instance_function" target="_blank">Test.assert()</a></td><td class="entry" headers="asserts__entry__2">Assert throws an exception if the test is false</td></tr><tr class="row"><td class="entry" headers="asserts__entry__1"><a class="xref" href="https://developer.garmin.com/connect-iq/api-docs/Toybox/Test.html#assert-instance_function" target="_blank">Test.assert()</a></td><td class="entry" headers="asserts__entry__2">Assert throws an exception and outputs a message if the test is false</td></tr><tr class="row"><td class="entry" headers="asserts__entry__1"><a class="xref" href="https://developer.garmin.com/connect-iq/api-docs/Toybox/Test.html#assertNotEqual-instance_function" target="_blank">Test.assertNotEqual()</a></td><td class="entry" headers="asserts__entry__2">Throws an exception if value1 and value2 are not equal</td></tr><tr class="row"><td class="entry" headers="asserts__entry__1"><a class="xref" href="https://developer.garmin.com/connect-iq/api-docs/Toybox/Test.html#assertNotEqualMessage-instance_function" target="_blank">Test.assertNotEqualMessage()</a></td><td class="entry" headers="asserts__entry__2">Throws an exception and outputs a message if value1 and value2 are not equal</td></tr></tbody></table></div></article><article aria-labelledby="ariaid-title3" class="topic nested1" id="unit-tests"><h2 class="title topictitle2" id="ariaid-title3">Unit Tests</h2><div class="body"><p class="p">Unit tests are a great way to check discrete pieces of your app for pass/fail criteria. Each test is run independently, so if a test fails or causes a crash, the test will be marked as a failed test and the next test will automatically be executed. This allows an entire suite of tests to be run with a single command in an automated fashion.</p><p class="p">Unit tests are written mostly like any other class, module, or function in Monkey C, but have the following requirements:</p><ul class="ul"><li class="li"><p class="p">Tests methods must be marked with the <code class="ph codeph">:test</code> annotation</p></li><li class="li"><p class="p">Test methods must take a <a class="xref" href="https://developer.garmin.com/connect-iq/api-docs/Toybox/Test/Logger.html" target="_blank">Test.Logger</a> object</p></li><li class="li"><p class="p">Tests methods that are not global (part of a test class or custom test module) must be static methods</p></li></ul><p class="p">Here is a simple example of a unit test method:</p><pre class="pre codeblock typescript"><code>// Unit test to check if 2 + 2 == 4
(:test)
function myUnitTest(logger as Logger) as Boolean {
  var x = 2 + 2; logger.debug("x = " + x);
  return (x == 4); // returning true indicates pass, false indicates failure
}</code></pre><p class="p">The unit tests include a handy logger with different logging levels for more meaningful error reporting. The sample code above uses a "debug" logging level, but the Logger contains a total of three logging levels that can be used to distinguish between different types of errors in your unit test output:</p><ul class="ul"><li class="li"><p class="p"><span class="xref"></span></p></li><li class="li"><p class="p"><span class="xref"></span></p></li><li class="li"><p class="p"><span class="xref"></span></p></li></ul><p class="p">While unit tests are defined in program source code, they are not included in debug or release executables.</p></div><article aria-labelledby="ariaid-title4" class="topic nested2" id="running-unit-tests-from-the-monkey-c-extension"><h3 class="title topictitle3" id="ariaid-title4">Running Unit Tests from the Monkey C Extension</h3><div class="body"><p class="p">The Monkey C Extension Test Explorer provides a powerful user interface for executing unit tests on your application. You can initiate the test explorer by clicking on the test tube icon on the left. When you start the test explorer, it will enumerate all tests in the code and list them by the module and class they belong to. You can configure which products you want to test by right clicking on an element and selecting <em class="ph i">Configure Devices</em>.</p><p class="p">Hitting the play button on a list element will run that test or the collection of tests contained by that element. The test output will be directed to the <em class="ph i">Test Results</em> tab next to the terminal section.</p></div></article><article aria-labelledby="ariaid-title5" class="topic nested2" id="running-unit-tests-from-the-command-line"><h3 class="title topictitle3" id="ariaid-title5">Running Unit Tests from the Command Line</h3><div class="body"><p class="p">If you want to run unit tests on your application, build the app with the <code class="ph codeph">--unit-test</code> flag on the build command to compile with unit tests. It's usually easiest to copy and paste the build command from the Visual Studio Code console and add the unit test flag. Then use the <code class="ph codeph">connectiq</code> script in your SDK's bin directory to launch the simulator from the terminal (no arguments required), and use the <code class="ph codeph">monkeydo</code> script in your SDK's bin directory with the <code class="ph codeph">/t</code> flag to run the app with unit tests enabled - <code class="ph codeph">monkeydo.bat path\to\projects\bin\MyApp.prg /t</code></p><p class="p">You may also supply a function name after /t to run the test associated with a single function. The sample unit test above produces the following output in the console:</p><pre class="pre codeblock bash"><code>Device Version 0.1.0
Device id 1 name "A garmin device"
Shell Version 0.1.0
\------------------------------------------------------------------------------
Executing test myUnitTestâ€¦
DEBUG (14:16): x = 4
Pass
==============================================================================
RESULTS
Test:              Status:
myUnitTest           Pass
Ran 1 test
PASSED (failures=0, errors=0)
Connection Finished
Closing shell and port</code></pre><p class="p">If you want to run tests in your <a class="xref" href="Shareable_Libraries.html#shareable-libraries">monkey barrel</a>, you can use the <code class="ph codeph">barreltest</code> script. It supports the <a class="xref" href="../Monkey_C/Compiler_Options.html#compiler-options">same options</a> as the compiler, but can output a PRG that can be used by the test system.</p><p class="p">Unit test code will not execute unless the compiler is explicitly told to run unit tests. All test code is automatically removed at compile time when your app is exported for use on devices.</p></div></article></article></article></main></div>
</body>
</html>